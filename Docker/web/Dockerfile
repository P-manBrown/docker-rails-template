# syntax=docker/dockerfile:1
FROM nginx:1.23.2

ARG USER_NAME='nginx'
ENV TZ='Asia/Tokyo'

RUN rm -f /etc/nginx/conf.d/*
COPY ./nginx/nginx.conf /etc/nginx/
COPY ./nginx/conf.d/myapp.conf /etc/nginx/conf.d/

RUN <<-EOF
	set -e
	chown -R "${USER_NAME}" /etc/nginx
	chown -R "${USER_NAME}" /var/cache/nginx
EOF
USER ${USER_NAME}

EXPOSE 80

CMD ["/usr/sbin/nginx", "-g", "daemon off;", "-c", "/etc/nginx/nginx.conf"]
